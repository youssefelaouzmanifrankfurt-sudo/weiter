// public/js/lager/controller-scan.js
console.log("ðŸ“· CONTROLLER-SCAN GELADEN");

window.triggerManualScan = function() {
     if (!window.socket) return;
     const code = document.getElementById('manual-code-input').value;
     if(code) {
         console.log("ðŸ“· Scan: Manueller Code", code);
         window.socket.emit('check-scan', code);
     }
};

window.filterStock = function() {
    // Einfache Client-Side Suche
    const term = document.ge// public/js/lager/workflow-inventory.js
console.log("ðŸ“¦ Workflow INVENTORY geladen");

window.WorkflowInventory = {
    process: function(item) {
        if (!item) return;
        console.log("ðŸ“¦ Starte Inventur-Workflow fÃ¼r:", item.title);

        // Wir nutzen das existierende Bearbeiten-Modal aus controller-stock.js
        if (window.openCreateModal) {
            
            // Scanner kurz pausieren, damit er nicht im Hintergrund weiter scannt
            if(window.ScanCtrl && window.ScanCtrl.stopQR) window.ScanCtrl.stopQR();
            
            // Modal mit Item-ID Ã¶ffnen
            window.openCreateModal(item.id || item._id);
            
            // Spezial-Logik: Fokus direkt auf das Mengen-Feld setzen
            setTimeout(() => {
                const qtyField = document.getElementById('inp-qty');
                if(qtyField) {
                    qtyField.focus();
                    qtyField.select(); // Inhalt markieren, damit man direkt Ã¼berschreiben kann
                }
                
                // Hinweis anzeigen
                if(window.showToast) window.showToast("Inventur: Bitte Menge prÃ¼fen", "info");
            }, 300);
        } else {
            console.error("âŒ window.openCreateModal fehlt! Ist controller-stock.js geladen?");
        }
    }
};tElementById('inp-search').value.toLowerCase();
    if(!window.lastStockItems) return;

    const filtered = window.lastStockItems.filter(item => 
        (item.title && item.title.toLowerCase().includes(term)) ||
        (item.sku && item.sku.toLowerCase().includes(term)) ||
        (item.location && item.location.toLowerCase().includes(term))
    );
    
    if(typeof window.renderStock === 'function') {
        window.renderStock(filtered);
    }
};